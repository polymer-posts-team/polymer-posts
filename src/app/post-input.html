<link rel="import" href="/bower_components/polymer/polymer-element.html">
<link rel="import" href="/bower_components/paper-button/paper-button.html">
<link rel="import" href="/bower_components/paper-input/paper-input.html">
<link rel="import" href="/bower_components/paper-card/paper-card.html">
<link rel="import" href="/bower_components/paper-input/paper-input-char-counter.html">
<link rel="import" href="/bower_components/paper-input/paper-textarea.html">
<link rel="import" href="/bower_components/iron-ajax/iron-ajax.html">
<script src="/bower_components/webcomponentsjs/webcomponents-lite.js"></script>



<dom-module id="post-input">
    <template>
        <custom-style>
            <style is="custom-style">
                textarea.text {
                    @apply --paper-input-container-shared-input-style;
                }
            </style>
        </custom-style>
        <style>
            .post {
                display: flex;
                flex-direction: column;
                padding: 30px;
                margin: 10px 0px 10px 10px;
                text-align: justify;
                background-color: whitesmoke;
            }

            paper-input.custom {
                --paper-input-container-underline: {
                    display: none;
                }
                ;
            }

            paper-input-container.custom {
                --paper-input-container-underline: {
                    display: none;
                }
                ;
            }

            paper-textarea.cont {
                --paper-input-container-underline: {
                    display: none;
                }
                ;
                --paper-input-container-underline-focus: {
                    display: none;
                }
                ;
            }

            .text {
                height: 200px;
            }

            #btn_post {
                left: 80%;
                top: 10px;
            }

            paper-button {
                background: green;
                color: white;
            }
        </style>
        <paper-card class="post">
            <div id="title">
                <paper-input class="custom" id="in_titulo" label="TITULO" always-float-label char-counter maxlength="140" required auto-validate
                    error-message="tu post requiere un muy buen titulo" value="{{title}}"></paper-input>
            </div>
            <div id="content">
                <paper-textarea id="in_contenido" class="cont" label="Contenido" no-label-float char-counter maxlength="240" rows="2" required
                    auto-validate error-message="necesitas plasmar tus ideas" value="{{body}}"></paper-textarea>
            </div>
            <div>
                <paper-button id="btn_post" on-click="posting">POST</paper-button>
            </div>
        </paper-card>
        <iron-ajax 
        id="peticion"
      method="POST"
      url="https://posts-services.herokuapp.com/posts" 
      hundle-s="json"
      content-type="application/json" 
      body="{{postear}}"
      last-response="{{postCreated}}">
    </iron-ajax>
    </template>
    <script>
        (function postInput(customElements) {

            'use strict';
            class PostInput extends Polymer.Element {
                static get is() { return 'post-input' };
                static get properties() {
                    return {
                        local: {
                            type: String,
                            value: 'local'
                        },
                        title:{type:String},
                        body:{type:String},
                        postear: {
                            type: Object,
                            computed: "getPostear(title,body)"
                        },
                        postCreated: {
                            type: Object,
                            notify: true
                        }
                    }
                }
                getPostear(title,body){
                    return {
                                 user: {
                                     email: localStorage.email
                                 },
                                 post: {
                                     title: title,
                                     body: body
                                 }
                             };
                }


                posting() {
                    this.$.peticion.generateRequest();
                }

            }
            customElements.define(PostInput.is, PostInput)
        }

        )(window.customElements);
    </script>

</dom-module>